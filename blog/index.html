
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>/usr/sbin/blog</title>
  <meta name="author" content="Alex Beal">

  
  <meta name="description" content="The Poisson process is a mathematical abstraction of random events happening over a stretch of time. It’s often used to model all sorts of &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://usrsb.in/blog">
  <link href="/blog/favicon.png" rel="icon">
  <link href="/blog/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/blog/javascripts/modernizr-2.0.js"></script>
  <script src="/blog/javascripts/ender.js"></script>
  <script src="/blog/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/blog/atom.xml" rel="alternate" title="/usr/sbin/blog" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-27836693-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/blog/">/usr/sbin/blog</a></h1>
  
    <h2>Alex's Geekery Journal.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/blog/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:usrsb.in/blog" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="http://usrsb.in">Home</a></li>
  <li><a href="/blog/">Blog</a></li>
  <li><a href="/blog/tools">Tools</a></li>
  <li><a href="/blog/about">About</a></li>
  <li><a href="/blog/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
    










    <article >
      
  <header>
    <h1 class="entry-title">

<a href="/blog/blog/2012/07/07/testing-with-the-poisson-process/">Testing With the Poisson Process</a>

</h1>

    
      <p class="meta">
        








  


<time datetime="2012-07-07T09:00:00-06:00" pubdate data-updated="true">Jul 7<span>th</span>, 2012</time>
         &bull; <a rel="bookmark" href="/blog/blog/2012/07/07/testing-with-the-poisson-process/">&infin;</a>
      </p>
    
  </header>

<div class="entry-content"><p>The Poisson process is a mathematical abstraction of random events happening over a stretch of time. It’s often used to model all sorts of occurrences from particle emission due to radioactive decay, to natural disasters.<sup>1</sup> The process itself has several mathematical properties such as not allowing for simultaneous events, but these specifics aren’t important for our purposes. What makes it useful to software engineers is that it also turns out to be a good model for events like hits to a webpage<sup>2</sup> or requests to an API. For example, suppose you have written a new API for your web site, and you wanted to test it out under normal load. In order to simulate this with a Poisson process, all you’d need to know is the expected number of hits per hour (or minute or second). With this information, you could then generate random inter-arrival times (the times between events). That is, you could model the amount of time between requests to your API using this equation:<sup>3</sup></p>

<p><img src="http://media.usrsb.in/poisson/0.png" alt="Exponentially distributed random variable" /></p>

<p>This is the equation for an exponentially distributed random variable, where <code>U</code> is a random number between 0 and 1, and <code>1/α</code> is the expected value of the inter-arrival times. In English, this means that if you expect 100 hits per hours, then <code>1/α</code> would equal 1/100 (because you expect there to be a hit every 0.01 hours), and <code>U</code> would be some random number generated with a call to <code>Math.random()</code>. The number that pops out the other end would be a randomly generated inter-request time. If you wanted to simulate more than one request, you would evaluate this equation multiple times (using a new randomly generated <code>U</code> each time), and each result would be the time between two requests. So if you ended up with 0.04, 0.2, 0.1, then the second request would come in 0.04 hours after the first, and the third would come in 0.2 hours after the second, and so on.</p>

<p>This technique can be automated using a simple Python script:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="c"># Make a function iterable, by repeatedly calling it.</span>
</span><span class='line'><span class="k">def</span> <span class="nf">make_iterable</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
</span><span class='line'>    <span class="k">try</span><span class="p">:</span>
</span><span class='line'>        <span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
</span><span class='line'>            <span class="k">yield</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
</span><span class='line'>    <span class="k">except</span><span class="p">:</span>
</span><span class='line'>        <span class="k">pass</span>
</span><span class='line'>
</span><span class='line'><span class="n">uni_rand</span> <span class="o">=</span> <span class="n">make_iterable</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="c"># A generator for inter arrival times.</span>
</span><span class='line'><span class="n">inter_arrival</span> <span class="o">=</span> <span class="p">(</span> <span class="o">-</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">u</span><span class="p">)</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">uni_rand</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>This creates a generator <code>inter_arrival</code> which generates one inter-arrival time every time it&#8217;s iterated on. Using this to test an API is as simple as:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="kn">import</span> <span class="nn">random</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">math</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">sys</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">time</span>
</span><span class='line'>
</span><span class='line'><span class="c"># Expected number of arrivals per unit time.</span>
</span><span class='line'><span class="n">a</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span class='line'><span class="c"># Number of events</span>
</span><span class='line'><span class="n">count</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</span><span class='line'>
</span><span class='line'><span class="c"># Function for testing API</span>
</span><span class='line'><span class="k">def</span> <span class="nf">test_api</span><span class="p">():</span>
</span><span class='line'>    <span class="k">print</span> <span class="s">&quot;Testing API...&quot;</span>
</span><span class='line'>    <span class="c"># TODO: Make request to the API</span>
</span><span class='line'>
</span><span class='line'><span class="c"># Make a function iterable, by repeatedly calling it.</span>
</span><span class='line'><span class="k">def</span> <span class="nf">make_iterable</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
</span><span class='line'>    <span class="k">try</span><span class="p">:</span>
</span><span class='line'>        <span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
</span><span class='line'>            <span class="k">yield</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
</span><span class='line'>    <span class="k">except</span><span class="p">:</span>
</span><span class='line'>        <span class="k">pass</span>
</span><span class='line'>
</span><span class='line'><span class="n">uni_rand</span> <span class="o">=</span> <span class="n">make_iterable</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="c"># A generator for inter-arrival times.</span>
</span><span class='line'><span class="n">inter_arrival</span> <span class="o">=</span> <span class="p">(</span> <span class="o">-</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">u</span><span class="p">)</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">uni_rand</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="c"># Generate inter-arrival times, then sleep for that long.</span>
</span><span class='line'><span class="n">inter_arrival_iter</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">inter_arrival</span><span class="p">)</span>
</span><span class='line'><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">count</span><span class="p">):</span>
</span><span class='line'>    <span class="n">inter_arrival_seconds</span> <span class="o">=</span> <span class="n">inter_arrival_iter</span><span class="o">.</span><span class="n">next</span><span class="p">()</span> <span class="o">*</span> <span class="mf">3600.</span>
</span><span class='line'>    <span class="k">print</span> <span class="s">&quot;Sleeping for </span><span class="si">%f</span><span class="s"> seconds.&quot;</span> <span class="o">%</span> <span class="n">inter_arrival_seconds</span>
</span><span class='line'>    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">inter_arrival_seconds</span><span class="p">)</span>
</span><span class='line'>    <span class="n">test_api</span><span class="p">()</span>
</span></code></pre></td></tr></table></div></figure>


<p>This script takes in two arguments. The first is the expected number of events per hour, and the second is the number of events to generate. The last loop is where the testing occurs. It generates one inter-arrival time, sleeps for that long, and then calls the <code>test_api</code> function which would need to be filled in with the API test.</p>

<p>Running this file with input <code>3600 10</code> generates 10 events, each one spaced by about 1 second:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="o">%</span> <span class="n">python</span> <span class="n">poisson</span><span class="o">.</span><span class="n">py</span> <span class="mi">3600</span> <span class="mi">10</span>
</span><span class='line'><span class="n">Sleeping</span> <span class="k">for</span> <span class="mf">1.710953</span> <span class="n">seconds</span><span class="o">.</span>
</span><span class='line'><span class="n">Testing</span> <span class="n">API</span><span class="o">...</span>
</span><span class='line'><span class="n">Sleeping</span> <span class="k">for</span> <span class="mf">5.028327</span> <span class="n">seconds</span><span class="o">.</span>
</span><span class='line'><span class="n">Testing</span> <span class="n">API</span><span class="o">...</span>
</span><span class='line'><span class="n">Sleeping</span> <span class="k">for</span> <span class="mf">0.511307</span> <span class="n">seconds</span><span class="o">.</span>
</span><span class='line'><span class="n">Testing</span> <span class="n">API</span><span class="o">...</span>
</span><span class='line'><span class="n">Sleeping</span> <span class="k">for</span> <span class="mf">2.336480</span> <span class="n">seconds</span><span class="o">.</span>
</span><span class='line'><span class="n">Testing</span> <span class="n">API</span><span class="o">...</span>
</span><span class='line'><span class="n">Sleeping</span> <span class="k">for</span> <span class="mf">1.594504</span> <span class="n">seconds</span><span class="o">.</span>
</span><span class='line'><span class="n">Testing</span> <span class="n">API</span><span class="o">...</span>
</span><span class='line'><span class="n">Sleeping</span> <span class="k">for</span> <span class="mf">0.308939</span> <span class="n">seconds</span><span class="o">.</span>
</span><span class='line'><span class="n">Testing</span> <span class="n">API</span><span class="o">...</span>
</span><span class='line'><span class="n">Sleeping</span> <span class="k">for</span> <span class="mf">0.682607</span> <span class="n">seconds</span><span class="o">.</span>
</span><span class='line'><span class="n">Testing</span> <span class="n">API</span><span class="o">...</span>
</span><span class='line'><span class="p">[</span><span class="n">snip</span><span class="p">]</span>
</span></code></pre></td></tr></table></div></figure>


<h3>References</h3>

<ol>
<li>Tijms, Henk. Understanding Probability: Chance Rules in Everyday Life. 2nd ed. New York: Cambridge University Press, 2010. 118. Print.</li>
<li>Arlitt, Martin F.; Williamson, Carey L. (1997). &#8220;Internet Web servers: Workload characterization and performance implications&#8221;. IEEE/ACM Transactions on Networking 5 (5): 631. DOI:10.1109/90.649565</li>
<li>Ibid 1. Page 124</li>
</ol>

</div>

  <footer>
    
    <p><a class="comments-link" href="/blog/blog/2012/07/07/testing-with-the-poisson-process/#disqus_thread">View comments &raquo;</a></p>
    
    
  </footer>


    </article>
  
    










    <article >
      
  <header>
    <h1 class="entry-title">

<a href="/blog/blog/2012/05/20/did-the-boulder-pd-reduce-traffic-accidents/">Did the Boulder PD Reduce Traffic Accidents?</a>

</h1>

    
      <p class="meta">
        








  


<time datetime="2012-05-20T09:00:00-06:00" pubdate data-updated="true">May 20<span>th</span>, 2012</time>
         &bull; <a rel="bookmark" href="/blog/blog/2012/05/20/did-the-boulder-pd-reduce-traffic-accidents/">&infin;</a>
      </p>
    
  </header>

<div class="entry-content"><p>There&#8217;s an article I came across a couple of years ago, which I filed away in the back of my brain, concerning the number of traffic accidents in Boulder. The police department increased enforcement at several intersections, and they were optimistic about the results. At all of the intersections, the number of accidents had dropped compared to the number of accidents in the year before.</p>

<blockquote><p>The police department&#8217;s traffic unit decided early last year to step up enforcement around three intersections that consistently rank among the top accident locations in the city&#8230;That meant placing more officers in marked cars at the intersection&#8230;Compared with 2008, last year saw 14 fewer accidents at those intersections, an 11 percent decrease.</p><footer><strong>The Daily Camera</strong> <cite><a href='http://www.dailycamera.com/ci_14456899'>www.dailycamera.com/ci_14456899/&hellip;</a></cite></footer></blockquote>


<p>The box to the left of the article presents the data, which I&#8217;ve reproduced below:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Accident data
</span><span class='line'>Intersection            2008    2009
</span><span class='line'>
</span><span class='line'>28th and Arapahoe       52      46
</span><span class='line'>
</span><span class='line'>30th and Arapahoe       39      33
</span><span class='line'>
</span><span class='line'>Foothills and Arapahoe  35      33
</span><span class='line'>
</span><span class='line'>Citywide                3,242   3,405
</span><span class='line'>
</span><span class='line'>Source: Boulder Police Department</span></code></pre></td></tr></table></div></figure>


<p>As you may have guessed, I was quite skeptical of this article. Just because a random variable varies from experiment to experiment, doesn&#8217;t mean the variation is anything but coincidence. I just flipped a coin 4 times. The first two times it was heads, and the second two, it was first heads and then tails. That, of course, doesn&#8217;t mean the coin suddenly became less lucky. So, the question I want to answer in this post is: <em>Is the Boulder PD justified in thinking that they&#8217;ve decreased the number of traffic accidents at these three intersections?</em></p>

<p>The way I&#8217;m going to answer this question is to first model these accidents with a probability distribution, and then use this to find the probability that the decrease in accidents could have been due to random variation. The distribution I&#8217;m going to use is a really interesting one called the Poisson distribution. This distribution is great for modeling events that happen very rarely, such as shark attacks and traffic accidents. Many people drive every day, but very few (relatively speaking) are involved in an accident. Further, this distribution has one parameter, λ, and both its variance and expected value are equal to it.</p>

<p><img src="http://media.usrsb.in/traffic-poisson/expected-var.png" title="Expected Value and Variance of the Poisson Distribution" ></p>

<p>The issue, of course, is that we don&#8217;t know the expected value or variance of traffic accidents at these intersections. We can, though, make a charitable assumption. In the interests of some fun mathematics, let&#8217;s assume that 2008 was an incredibly average year, and that the number of accidents that occurred that year is exactly the expected value. Since the variance is equal to the expected value, we can, for example, say that the variance is 52 for 28th and Arapahoe.</p>

<p>Now that we know the variance and expected value, we can calculate the <em>z-score</em> of the decrease in accidents. This will tell us the probability that the random variable (in this case, the number of accidents at 28th and Arapahoe) could, by mere chance, decrease by 6 to 46. But wait a minute. z-scores only pertain to normal distributions, and we&#8217;re using the Poisson distribution. This is ok, though. Since λ is large (λ > 25) it can be approximated with the normal distribution.<sup>1</sup> So, let&#8217;s calculate the z-score:</p>

<p><img src="http://media.usrsb.in/traffic-poisson/z-val.png" title="z-value of the Normal Distribution" ></p>

<p><img src="http://media.usrsb.in/traffic-poisson/z-val-calc.png" title="z-value of the reduction = 0.832" ></p>

<p>We now know that a decrease of 6 accidents from 52 falls at exactly -0.832 standard deviations from the mean. From this, we can tell that <a href="http://www.wolframalpha.com/input/?i=z-score+-0.832">the chance that the number of accidents in a given year would vary between 46 and 58 (±6 from the mean of 52) is 60%,</a> and the chance that the number of accidents would be something less than or equal to 46 is 20%. So, it seems quite likely that this variation was just random coincidence. The Boulder PD is probably being a bit too optimistic in thinking that it&#8217;s their additional enforcement that decreased the number of traffic accidents at 28th and Arapahoe. Now, what about the other intersections? I&#8217;ve repeated this calculation for the other three statistics below:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Accident data
</span><span class='line'>Intersection            2008    2009    z-value     P(z &lt; z-value) (left tailed p-value)
</span><span class='line'>
</span><span class='line'>28th and Arapahoe       52      46      -0.832      0.202
</span><span class='line'>
</span><span class='line'>30th and Arapahoe       39      33      -0.971      0.1683
</span><span class='line'>
</span><span class='line'>Foothills and Arapahoe  35      33      -0.334      0.369
</span><span class='line'>
</span><span class='line'>Citywide                3,242   3,405    2.862      0.0021 (right tailed)</span></code></pre></td></tr></table></div></figure>


<p>The decrease at 30th and Arapahoe is slightly more significant, but still has a 17% chance of being due to randomness. Foothills and Arapahoe fairs the worst of the three, with a whopping 37% chance of being random. Ironically, it is the citywide <em>increase</em> in accidents that is the most significant result. There&#8217;s only a 0.2% chance that the number of accidents would randomly increase by at least 163! This is statistically significant, and it&#8217;s plausible that this variation isn&#8217;t due to random chance. Perhaps the Boulder PD spent too much time at these intersections at a cost to all of the other intersections in the city!</p>

<p>In any case, this analysis is, of course, far from perfect. The assumption I made concerning the expected value may very well have been wrong. Perhaps both 2008 and 2009 were anomalous years, and the expected value is actually much different. I will also grant that it is interesting that the citywide total went up, while these three intersections all went down, but I&#8217;m also not sure how much cherry picking they did. Really, the point of this post was to showcase some interesting mathematics, and show how far a little algebra can go. With only a little more data, I think this sort of analysis would have some interesting results. Hopefully someone at Boulder PD is listening. I wonder how much more money they threw at this enforcement campaign without really having any good data on its efficacy.</p>

<h3>Notes</h3>

<ol>
<li>Tijms, Henk. Understanding Probability: Chance Rules in Everyday Life. 2nd ed. New York: Cambridge University Press, 2010. 169. Print.</li>
</ol>

</div>

  <footer>
    
    <p><a class="comments-link" href="/blog/blog/2012/05/20/did-the-boulder-pd-reduce-traffic-accidents/#disqus_thread">View comments &raquo;</a></p>
    
    
  </footer>


    </article>
  
    










    <article >
      
  <header>
    <h1 class="entry-title">

<a href="/blog/blog/2012/05/05/permutations-an-interview-question/">Permutations: An Interview Question</a>

</h1>

    
      <p class="meta">
        








  


<time datetime="2012-05-05T13:41:00-06:00" pubdate data-updated="true">May 5<span>th</span>, 2012</time>
         &bull; <a rel="bookmark" href="/blog/blog/2012/05/05/permutations-an-interview-question/">&infin;</a>
      </p>
    
  </header>

<div class="entry-content"><p>Here I go over a coding question I was recently asked during an interview.</p>

<iframe width="853" height="480" src="http://www.youtube.com/embed/wIPcruaQ3Sg" frameborder="0" allowfullscreen></iframe>


<p>You can find the source here: <a href="https://gist.github.com/2604992">https://gist.github.com/2604992</a></p>

<h3>Notes</h3>

<ol>
<li>In some languages, prepending to a list is faster than appending. In Python it doesn&#8217;t matter.</li>
<li>The weird characters in the Vim session are whitespace characters. <code>$</code> is a newline character.</li>
</ol>

</div>

  <footer>
    
    <p><a class="comments-link" href="/blog/blog/2012/05/05/permutations-an-interview-question/#disqus_thread">View comments &raquo;</a></p>
    
    
  </footer>


    </article>
  
    










    <article >
      
  <header>
    <h1 class="entry-title">

<a href="/blog/blog/2012/04/07/look-ma-no-loops/">Look, Ma! No Loops: Reversing Word Order</a>

</h1>

    
      <p class="meta">
        








  


<time datetime="2012-04-07T17:08:00-06:00" pubdate data-updated="true">Apr 7<span>th</span>, 2012</time>
         &bull; <a rel="bookmark" href="/blog/blog/2012/04/07/look-ma-no-loops/">&infin;</a>
      </p>
    
  </header>

<div class="entry-content"><p>Here&#8217;s a classic interview question:</p>

<blockquote><p>Write a function that takes a string and reverses its word order. So, &#8220;Reverse this string&#8221; results in &#8220;string this Reverse&#8221;.</p></blockquote>

<p>Notice that the task isn&#8217;t to reverse the string, but rather to reverse the order of the string&#8217;s words. So the first word becomes the last. The second word becomes the second to last, and so on.</p>

<p>Whenever I come across puzzles like this, I shudder when I start to think about the nested loops and pointer arithmetic. Unfortunately, that describes the classic solution pretty well. The common wisdom is that first you should reverse the entire string. Then you should go back and reverse each word. So:</p>

<ol>
<li>&#8220;Reverse this&#8221;</li>
<li>&#8220;siht esreveR&#8221;</li>
<li>&#8220;this Reverse&#8221;</li>
</ol>


<p>The first step isn&#8217;t bad, but reversing each word will require at least one nested loop, and some careful thinking about how to deal with the spaces. Instead, let&#8217;s think through a functional solution that doesn&#8217;t involve any loops. It will necessarily be recursive, so the first step will be to come up with each of the cases we&#8217;ll encouter as we walk the string.</p>

<ul>
<li>Recursive Case 1: We&#8217;re in the midst of a word. Add the current letter to the end of some word accumulator.</li>
<li>Recursive Case 2: We&#8217;re at the end of a word (a space). Add the current word accumulator to the beginning of some string accumulator, then clear the word accumulator.</li>
<li>Base Case: The string is empty. Return the word accumulator prepended to the string accumulator.</li>
</ul>


<p>So, there are two accumulators. One grabs the letters of each word as we walk the string and keeps the letters <em>in order</em> (the word accumulator). Then, once an entire word has been read into the word accumulator, it&#8217;s prepended to the string accumulator. Prepending, reverses the word order. Once it&#8217;s prepended, the word accumulator is cleared in preparation for the next word. Let&#8217;s translate this case by case.</p>

<p>The base case is the easiest. Let&#8217;s start there:</p>

<figure class='code'><figcaption><span>Base Case</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span class='line'>    <span class="k">return</span> <span class="n">word_acc</span> <span class="o">+</span> <span class="n">str_acc</span>
</span></code></pre></td></tr></table></div></figure>


<p>Start by testing if the input string, <code>s</code>, is empty. If it is, then we&#8217;ve reached the end of the string, so we return the contents of the <code>word_acc</code>, prepended to the <code>str_acc</code>. <code>word_acc</code> contains the last word in the string, and we&#8217;re prepending it to the rest of the string that has already been reversed.</p>

<p>Now let&#8217;s deal with the second recursive case:</p>

<figure class='code'><figcaption><span>2nd Recursive Case</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="k">elif</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&quot; &quot;</span><span class="p">:</span>
</span><span class='line'>    <span class="k">return</span> <span class="n">helper</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="s">&quot; &quot;</span> <span class="o">+</span> <span class="n">word_acc</span> <span class="o">+</span> <span class="n">str_acc</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>If we&#8217;ve gotten this far, the input string must have some length, so we check if the first character is a space. If it is, we&#8217;ve reached the end of a word, so we need to prepend <code>str_acc</code> with the word that&#8217;s just been read in (<code>word_acc</code>). We then clear out the <code>word_acc</code> in preparation for the next word, and recursively call the function with the rest of the input string, <code>s</code>. The recursive call is to <code>helper</code> because this will be nested inside a convenience wrapper that only takes one argument.</p>

<p>Finally, the last case:</p>

<figure class='code'><figcaption><span>1st Recursive Case</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="k">else</span><span class="p">:</span>
</span><span class='line'>    <span class="k">return</span> <span class="n">helper</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">word_acc</span> <span class="o">+</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">str_acc</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>If we&#8217;ve gotten this far, we&#8217;re in the midst of a word (the string isn&#8217;t empty, and the current character isn&#8217;t a space). In this case, we add the current character onto the <code>word_acc</code> and then recurse with the rest of the string. Remember, the <code>word_acc</code> is building up each word character by character as we walk the input string.</p>

<p>Finally, we can simply throw these cases into a function, and it should just work. Ahh, the magic of recursion.</p>

<figure class='code'><figcaption><span>Reversing Word Order</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="k">def</span> <span class="nf">rev_words</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
</span><span class='line'>    <span class="sd">&#39;&#39;&#39;Returns the string `s` with its words in the reverse order.</span>
</span><span class='line'><span class="sd">       Example: rev_words(&quot;Reverse this!&quot;) #&quot;this! Reverse&quot;</span>
</span><span class='line'><span class="sd">    &#39;&#39;&#39;</span>
</span><span class='line'>    <span class="k">def</span> <span class="nf">helper</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">word_acc</span><span class="p">,</span> <span class="n">str_acc</span><span class="p">):</span>
</span><span class='line'>        <span class="c"># Base case: Return word accumulator plus whatever words</span>
</span><span class='line'>        <span class="c"># you have in the string acc</span>
</span><span class='line'>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span class='line'>            <span class="k">return</span> <span class="n">word_acc</span> <span class="o">+</span> <span class="n">str_acc</span>
</span><span class='line'>        <span class="c"># This is the end of a word. Clear `word_acc`, and start with</span>
</span><span class='line'>        <span class="c"># the next word.</span>
</span><span class='line'>        <span class="k">elif</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&quot; &quot;</span><span class="p">:</span>
</span><span class='line'>            <span class="k">return</span> <span class="n">helper</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="s">&quot; &quot;</span> <span class="o">+</span> <span class="n">word_acc</span> <span class="o">+</span> <span class="n">str_acc</span><span class="p">)</span>
</span><span class='line'>        <span class="c"># In the middle of a word. Add the letter to `word_acc`, and continue</span>
</span><span class='line'>        <span class="k">else</span><span class="p">:</span>
</span><span class='line'>            <span class="k">return</span> <span class="n">helper</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">word_acc</span> <span class="o">+</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">str_acc</span><span class="p">)</span>
</span><span class='line'>    <span class="k">return</span> <span class="n">helper</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>As much as I like this solution, it&#8217;s not without its drawbacks. The most significant is that Python&#8217;s string methods are very slow. Each concatenation causes both strings to be copied, and at least one concat is happening for each character in the string. Possible solutions include turning the string into a list of characters (list methods are much faster), or using a language that better supports the functional paradigm.<sup>1</sup> But really, if speed is your highest priority, the imperative solution of swapping characters in place is your best bet, warts and all.</p>

<p>If you&#8217;d like to play with this code yourself, I&#8217;ve posted <a href="https://gist.github.com/2331327">a gist here</a>, along with some tests.</p>

<h3>Notes</h3>

<ol>
<li>If Python had a constant time prepend function (&#8216;cons&#8217; in the functional world), I suspect a better solution would be possible.</li>
</ol>

</div>

  <footer>
    
    <p><a class="comments-link" href="/blog/blog/2012/04/07/look-ma-no-loops/#disqus_thread">View comments &raquo;</a></p>
    
    
  </footer>


    </article>
  
    










    <article >
      
  <header>
    <h1 class="entry-title">

<a href="/blog/blog/2012/04/01/building-data-structures-from-functions/">Building Data Structures From Functions</a>

</h1>

    
      <p class="meta">
        








  


<time datetime="2012-04-01T09:00:00-06:00" pubdate data-updated="true">Apr 1<span>st</span>, 2012</time>
         &bull; <a rel="bookmark" href="/blog/blog/2012/04/01/building-data-structures-from-functions/">&infin;</a>
      </p>
    
  </header>

<div class="entry-content"><p>Here&#8217;s a puzzle I&#8217;ve adapted from <a href="http://mitpress.mit.edu/sicp/full-text/book/book-Z-H-14.html#%_sec_2.1.3">exercise 2.4</a> of SICP.</p>

<blockquote><p>Suppose you are programming in a language that only supports function application. That is, defining functions and applying arguments to these functions are the only things this language supports. Using only these building blocks, could you construct a linked list?</p></blockquote>

<p>Surprisingly, the answer is yes, and the exercise linked to above provides a partial solution. Below, I&#8217;ve translated that solution into Python, and completed the exercise:</p>

<figure class='code'><figcaption><span>Solution in Python</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="c"># Create a pair from l and r</span>
</span><span class='line'><span class="k">def</span> <span class="nf">cons</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">lambda</span> <span class="n">get</span><span class="p">:</span> <span class="n">get</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
</span><span class='line'><span class="c"># Given a pair, return the head (left) value.</span>
</span><span class='line'><span class="k">def</span> <span class="nf">head</span><span class="p">(</span><span class="n">pair</span><span class="p">):</span>
</span><span class='line'>    <span class="k">return</span> <span class="n">pair</span><span class="p">(</span><span class="k">lambda</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">:</span> <span class="n">l</span><span class="p">)</span>
</span><span class='line'><span class="c"># Give a pair, return the tail (right) value.</span>
</span><span class='line'><span class="k">def</span> <span class="nf">tail</span><span class="p">(</span><span class="n">pair</span><span class="p">):</span>
</span><span class='line'>    <span class="k">return</span> <span class="n">pair</span><span class="p">(</span><span class="k">lambda</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">:</span> <span class="n">r</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>First, let&#8217;s examine how these functions can be used, and then I&#8217;ll explain how they work. Consider the snippet below:</p>

<figure class='code'><figcaption><span>Usage Example</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="n">l1</span> <span class="o">=</span> <span class="n">cons</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span><span class='line'><span class="k">print</span> <span class="n">head</span><span class="p">(</span><span class="n">l1</span><span class="p">)</span>       <span class="c"># Prints 1</span>
</span><span class='line'><span class="k">print</span> <span class="n">tail</span><span class="p">(</span><span class="n">l1</span><span class="p">)</span>       <span class="c"># Prints 2</span>
</span><span class='line'><span class="n">l2</span> <span class="o">=</span> <span class="n">cons</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">l1</span><span class="p">)</span>
</span><span class='line'><span class="k">print</span> <span class="n">head</span><span class="p">(</span><span class="n">l2</span><span class="p">)</span>       <span class="c"># Prints 0</span>
</span><span class='line'><span class="k">print</span> <span class="n">head</span><span class="p">(</span><span class="n">tail</span><span class="p">(</span><span class="n">l2</span><span class="p">))</span> <span class="c"># Prints 1</span>
</span><span class='line'><span class="k">print</span> <span class="n">tail</span><span class="p">(</span><span class="n">tail</span><span class="p">(</span><span class="n">l2</span><span class="p">))</span> <span class="c"># Prints 2</span>
</span></code></pre></td></tr></table></div></figure>


<p>As can be seen, <code>cons()</code> is the constructor for this pair type. Give it two values, and it will create a pair of those two values. <code>head()</code> and <code>tail()</code> are the basic operators that let us access values inside these pairs; they return the left and right element of the pair, respectively. Also notice that we can create pairs of pairs. The last half of the example creates a pair composed of <code>0</code> and <code>(1,2)</code>. Why is this significant? Well, we&#8217;ve just made a linked list! Linked lists are simply pairs of pairs. The list <code>[1,2,3,4]</code> can, for example, be represented as <code>cons(1,cons(2,cons(3,cons(4,None))))</code>. What&#8217;s <code>None</code> doing at the end of the list? You can think of it like the <code>NULL</code> pointer at the end of a linked list in C. If a function were traversing the list, <code>None</code> would signify to the function that it has reached the end. Mathematically, you can think of a linked list as an inductively defined data structure, where <code>None</code> is the base case. <code>None</code> is referred to as the <em>empty list</em>.</p>

<p>Now for the interesting part. How do these functions work? First let&#8217;s look at the <code>cons()</code> function:</p>

<figure class='code'><figcaption><span>cons()</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="c"># Create a pair from l and r</span>
</span><span class='line'><span class="k">def</span> <span class="nf">cons</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">lambda</span> <span class="n">get</span><span class="p">:</span> <span class="n">get</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>This takes in two parameters (<code>l</code> and <code>r</code>) and returns a function.<sup>1</sup> This returned function takes yet another function, which it applies to <code>l</code> and <code>r</code> and returns the result. So, if we call <code>cons(1,2)</code>, we are returned a function, which takes a function and applies that function to the arguments <code>1</code> and <code>2</code>. If, for example, I called <code>cons(1,2)(lambda x, y: x+y)</code> I&#8217;d get <code>3</code>, because the addition function would be applied to <code>1</code> and <code>2</code>.</p>

<p>Now suppose that we didn&#8217;t want to add <code>l</code> and <code>r</code>. Instead, we wanted to pull either <code>l</code> or <code>r</code> out of a pair that was already constructed. In other words, given <code>list = cons(1,2)</code>, how could we pull the <code>1</code> or <code>2</code> out of the function stored in <code>list</code>? Well, all we need to do is pass it a function that returns only the left or right parameter. So, <code>cons(1,2)(lambda l, r: l)</code> would give us back <code>1</code>, and <code>cons(1,2)(lambda l,r: r)</code> would give us back <code>2</code>. This is almost exactly what the <code>head()</code> and <code>tail()</code> functions are doing! They take in a function (presumably produced by the <code>cons()</code> function), and apply either <code>lambda l,r: l</code> or <code>lambda l,r: r</code>. Just to cement this all together, below I step through the evaluation for the example <code>head(cons(1,2))</code>.</p>

<figure class='code'><figcaption><span>Evaluation Steps for head(cons(1,2,))</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="n">head</span><span class="p">(</span><span class="n">cons</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
</span><span class='line'><span class="o">-&gt;</span> <span class="n">head</span><span class="p">(</span><span class="k">lambda</span> <span class="n">get</span><span class="p">:</span> <span class="n">get</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</span><span class='line'><span class="o">-&gt;</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">get</span><span class="p">:</span> <span class="n">get</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))(</span><span class="k">lambda</span> <span class="n">l</span><span class="p">,</span><span class="n">r</span><span class="p">:</span> <span class="n">l</span><span class="p">)</span>
</span><span class='line'><span class="o">-&gt;</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">l</span><span class="p">,</span><span class="n">r</span><span class="p">:</span> <span class="n">l</span><span class="p">)(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</span><span class='line'><span class="o">-&gt;</span> <span class="mi">1</span>
</span></code></pre></td></tr></table></div></figure>


<p>And here is a bit of code that uses these new functions to add the elements of a list:</p>

<figure class='code'><figcaption><span>Sum Function</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="k">def</span> <span class="nf">sum_list</span><span class="p">(</span><span class="n">l</span><span class="p">):</span>
</span><span class='line'>    <span class="k">return</span> <span class="n">head</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="k">if</span> <span class="n">tail</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">==</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">head</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">+</span> <span class="n">sum_list</span><span class="p">(</span><span class="n">tail</span><span class="p">(</span><span class="n">l</span><span class="p">))</span>
</span><span class='line'><span class="n">sum_list</span><span class="p">(</span><span class="n">cons</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">cons</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">cons</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="bp">None</span><span class="p">))))</span> <span class="c"># Returns 6</span>
</span></code></pre></td></tr></table></div></figure>


<p>In the end, this might strike you as nothing more than a useless programming trick. In a sense that&#8217;s right. I&#8217;d never use this in my own code. What makes this technique so valuable is that it actually fits into the broader context of lambda calculus, which is a mathematical abstraction of computation. In the language of lambda calculus, you&#8217;re given only a very basic set of tools. Essentially all you have are simple one parameter functions (it doesn&#8217;t even have integers!). Incredibly, it turns out that that&#8217;s all you need for a Turing complete language. It&#8217;s possible to build integers, conditionals, loops, arithmetic operations, and (as you&#8217;ve seen here) data structures out of these simple building blocks. As a next step, and to see this for yourself, it might be fun to take a minute and see how the code presented here could be modified to give you binary trees, or even graphs. After that, you could check out this incredible article on writing the infamous <a href="http://www.codinghorror.com/blog/2007/02/why-cant-programmers-program.html">FizzBuzz</a> exercise <a href="http://experthuman.com/programming-with-nothing">in Ruby using only functions</a>.</p>

<h3>Notes</h3>

<ol>
<li>Technically, this is really a closure, which is a function with some of its variables already set. In the terminology of the PL world, it&#8217;s a function bundled with its environment (the set of variables in its outer scope).</li>
</ol>

</div>

  <footer>
    
    <p><a class="comments-link" href="/blog/blog/2012/04/01/building-data-structures-from-functions/#disqus_thread">View comments &raquo;</a></p>
    
    
  </footer>


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/blog/page/2/">&larr; Older</a>
    
    <a href="/blog/blog/archives">Blog Archives</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/blog/2012/07/07/testing-with-the-poisson-process/">Testing With The Poisson Process</a>
      </li>
    
      <li class="post">
        <a href="/blog/blog/2012/05/20/did-the-boulder-pd-reduce-traffic-accidents/">Did the Boulder PD Reduce Traffic Accidents?</a>
      </li>
    
      <li class="post">
        <a href="/blog/blog/2012/05/05/permutations-an-interview-question/">Permutations: An Interview Question</a>
      </li>
    
      <li class="post">
        <a href="/blog/blog/2012/04/07/look-ma-no-loops/">Look, Ma! No Loops: Reversing Word Order</a>
      </li>
    
      <li class="post">
        <a href="/blog/blog/2012/04/01/building-data-structures-from-functions/">Building Data Structures from Functions</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/beala">@beala</a> on GitHub
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'beala',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/blog/javascripts/github.js" type="text/javascript"> </script>
</section>


<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("beala", 4, false);
    });
  </script>
  <script src="/blog/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/beala" class="twitter-follow-button" data-show-count="false">Follow @beala</a>
  
</section>


<section>
  <h1>My Pinboard</h1>
  <ul id="pinboard_linkroll">Fetching linkroll&#8230;</ul>
  <p><a href="http://pinboard.in/u:beala">My Pinboard Bookmarks &raquo;</a></p>
</section>
<script type="text/javascript">
  var linkroll = 'pinboard_linkroll'; //id target for pinboard list
  var pinboard_user = "beala"; //id target for pinboard list
  var pinboard_count = 3; //id target for pinboard list
  (function(){
    var pinboardInit = document.createElement('script');
    pinboardInit.type = 'text/javascript';
    pinboardInit.async = true;
    pinboardInit.src = '/javascripts/pinboard.js';
    document.getElementsByTagName('head')[0].appendChild(pinboardInit);
  })();
</script>




  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2012 - Alex Beal -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'usrsbin';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
