
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>/usr/sbin/blog</title>
  <meta name="author" content="Alex Beal">

  
  <meta name="description" content="Here I go over a coding question I was recently asked during an interview. You can find the source here: https://gist.github.com/2604992 Notes In &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://blog.usrsb.in">
  <link href="/blog/favicon.png" rel="icon">
  <link href="/blog/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/blog/javascripts/modernizr-2.0.js"></script>
  <script src="/blog/javascripts/ender.js"></script>
  <script src="/blog/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/blog/atom.xml" rel="alternate" title="/usr/sbin/blog" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-27836693-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/blog/">/usr/sbin/blog</a></h1>
  
    <h2>Alex's Geekery Journal.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/blog/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:blog.usrsb.in" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="https://usrsb.in">Home</a></li>
  <li><a href="/blog/">Blog</a></li>
  <li><a href="/blog/tools">Tools</a></li>
  <li><a href="/blog/about">About</a></li>
  <li><a href="/blog/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
    










    <article >
      
  <header>
    <h1 class="entry-title">

<a href="/blog/blog/2012/05/05/permutations-an-interview-question/">Permutations: An Interview Question</a>

</h1>

    
      <p class="meta">
        








  


<time datetime="2012-05-05T13:41:00-06:00" pubdate data-updated="true">May 5<span>th</span>, 2012</time>
         &bull; <a rel="bookmark" href="/blog/blog/2012/05/05/permutations-an-interview-question/">&infin;</a>
      </p>
    
  </header>

<div class="entry-content"><p>Here I go over a coding question I was recently asked during an interview.</p>

<iframe width="853" height="480" src="http://www.youtube.com/embed/wIPcruaQ3Sg" frameborder="0" allowfullscreen></iframe>


<p>You can find the source here: <a href="https://gist.github.com/2604992">https://gist.github.com/2604992</a></p>

<h3>Notes</h3>

<ol>
<li>In some languages, prepending to a list is faster than appending. In Python it doesn&#8217;t matter.</li>
<li>The weird characters in the Vim session are whitespace characters. <code>$</code> is a newline character.</li>
</ol>

</div>

  <footer>
    
    
  </footer>


    </article>
  
    










    <article >
      
  <header>
    <h1 class="entry-title">

<a href="/blog/blog/2012/04/07/look-ma-no-loops/">Look, Ma! No Loops: Reversing Word Order</a>

</h1>

    
      <p class="meta">
        








  


<time datetime="2012-04-07T17:08:00-06:00" pubdate data-updated="true">Apr 7<span>th</span>, 2012</time>
         &bull; <a rel="bookmark" href="/blog/blog/2012/04/07/look-ma-no-loops/">&infin;</a>
      </p>
    
  </header>

<div class="entry-content"><p>Here&#8217;s a classic interview question:</p>

<blockquote><p>Write a function that takes a string and reverses its word order. So, &#8220;Reverse this string&#8221; results in &#8220;string this Reverse&#8221;.</p></blockquote>

<p>Notice that the task isn&#8217;t to reverse the string, but rather to reverse the order of the string&#8217;s words. So the first word becomes the last. The second word becomes the second to last, and so on.</p>

<p>Whenever I come across puzzles like this, I shudder when I start to think about the nested loops and pointer arithmetic. Unfortunately, that describes the classic solution pretty well. The common wisdom is that first you should reverse the entire string. Then you should go back and reverse each word. So:</p>

<ol>
<li>&#8220;Reverse this&#8221;</li>
<li>&#8220;siht esreveR&#8221;</li>
<li>&#8220;this Reverse&#8221;</li>
</ol>


<p>The first step isn&#8217;t bad, but reversing each word will require at least one nested loop, and some careful thinking about how to deal with the spaces. Instead, let&#8217;s think through a functional solution that doesn&#8217;t involve any loops. It will necessarily be recursive, so the first step will be to come up with each of the cases we&#8217;ll encouter as we walk the string.</p>

<ul>
<li>Recursive Case 1: We&#8217;re in the midst of a word. Add the current letter to the end of some word accumulator.</li>
<li>Recursive Case 2: We&#8217;re at the end of a word (a space). Add the current word accumulator to the beginning of some string accumulator, then clear the word accumulator.</li>
<li>Base Case: The string is empty. Return the word accumulator prepended to the string accumulator.</li>
</ul>


<p>So, there are two accumulators. One grabs the letters of each word as we walk the string and keeps the letters <em>in order</em> (the word accumulator). Then, once an entire word has been read into the word accumulator, it&#8217;s prepended to the string accumulator. Prepending, reverses the word order. Once it&#8217;s prepended, the word accumulator is cleared in preparation for the next word. Let&#8217;s translate this case by case.</p>

<p>The base case is the easiest. Let&#8217;s start there:</p>

<figure class='code'><figcaption><span>Base Case</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span class='line'>    <span class="k">return</span> <span class="n">word_acc</span> <span class="o">+</span> <span class="n">str_acc</span>
</span></code></pre></td></tr></table></div></figure>


<p>Start by testing if the input string, <code>s</code>, is empty. If it is, then we&#8217;ve reached the end of the string, so we return the contents of the <code>word_acc</code>, prepended to the <code>str_acc</code>. <code>word_acc</code> contains the last word in the string, and we&#8217;re prepending it to the rest of the string that has already been reversed.</p>

<p>Now let&#8217;s deal with the second recursive case:</p>

<figure class='code'><figcaption><span>2nd Recursive Case</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="k">elif</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&quot; &quot;</span><span class="p">:</span>
</span><span class='line'>    <span class="k">return</span> <span class="n">helper</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="s">&quot; &quot;</span> <span class="o">+</span> <span class="n">word_acc</span> <span class="o">+</span> <span class="n">str_acc</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>If we&#8217;ve gotten this far, the input string must have some length, so we check if the first character is a space. If it is, we&#8217;ve reached the end of a word, so we need to prepend <code>str_acc</code> with the word that&#8217;s just been read in (<code>word_acc</code>). We then clear out the <code>word_acc</code> in preparation for the next word, and recursively call the function with the rest of the input string, <code>s</code>. The recursive call is to <code>helper</code> because this will be nested inside a convenience wrapper that only takes one argument.</p>

<p>Finally, the last case:</p>

<figure class='code'><figcaption><span>1st Recursive Case</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="k">else</span><span class="p">:</span>
</span><span class='line'>    <span class="k">return</span> <span class="n">helper</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">word_acc</span> <span class="o">+</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">str_acc</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>If we&#8217;ve gotten this far, we&#8217;re in the midst of a word (the string isn&#8217;t empty, and the current character isn&#8217;t a space). In this case, we add the current character onto the <code>word_acc</code> and then recurse with the rest of the string. Remember, the <code>word_acc</code> is building up each word character by character as we walk the input string.</p>

<p>Finally, we can simply throw these cases into a function, and it should just work. Ahh, the magic of recursion.</p>

<figure class='code'><figcaption><span>Reversing Word Order</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="k">def</span> <span class="nf">rev_words</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
</span><span class='line'>    <span class="sd">&#39;&#39;&#39;Returns the string `s` with its words in the reverse order.</span>
</span><span class='line'><span class="sd">       Example: rev_words(&quot;Reverse this!&quot;) #&quot;this! Reverse&quot;</span>
</span><span class='line'><span class="sd">    &#39;&#39;&#39;</span>
</span><span class='line'>    <span class="k">def</span> <span class="nf">helper</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">word_acc</span><span class="p">,</span> <span class="n">str_acc</span><span class="p">):</span>
</span><span class='line'>        <span class="c"># Base case: Return word accumulator plus whatever words</span>
</span><span class='line'>        <span class="c"># you have in the string acc</span>
</span><span class='line'>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span class='line'>            <span class="k">return</span> <span class="n">word_acc</span> <span class="o">+</span> <span class="n">str_acc</span>
</span><span class='line'>        <span class="c"># This is the end of a word. Clear `word_acc`, and start with</span>
</span><span class='line'>        <span class="c"># the next word.</span>
</span><span class='line'>        <span class="k">elif</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&quot; &quot;</span><span class="p">:</span>
</span><span class='line'>            <span class="k">return</span> <span class="n">helper</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="s">&quot; &quot;</span> <span class="o">+</span> <span class="n">word_acc</span> <span class="o">+</span> <span class="n">str_acc</span><span class="p">)</span>
</span><span class='line'>        <span class="c"># In the middle of a word. Add the letter to `word_acc`, and continue</span>
</span><span class='line'>        <span class="k">else</span><span class="p">:</span>
</span><span class='line'>            <span class="k">return</span> <span class="n">helper</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">word_acc</span> <span class="o">+</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">str_acc</span><span class="p">)</span>
</span><span class='line'>    <span class="k">return</span> <span class="n">helper</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>As much as I like this solution, it&#8217;s not without its drawbacks. The most significant is that Python&#8217;s string methods are very slow. Each concatenation causes both strings to be copied, and at least one concat is happening for each character in the string. Possible solutions include turning the string into a list of characters (list methods are much faster), or using a language that better supports the functional paradigm.<sup>1</sup> But really, if speed is your highest priority, the imperative solution of swapping characters in place is your best bet, warts and all.</p>

<p>If you&#8217;d like to play with this code yourself, I&#8217;ve posted <a href="https://gist.github.com/2331327">a gist here</a>, along with some tests.</p>

<h3>Notes</h3>

<ol>
<li>If Python had a constant time prepend function (&#8216;cons&#8217; in the functional world), I suspect a better solution would be possible.</li>
</ol>

</div>

  <footer>
    
    
  </footer>


    </article>
  
    










    <article >
      
  <header>
    <h1 class="entry-title">

<a href="/blog/blog/2012/04/01/building-data-structures-from-functions/">Building Data Structures From Functions</a>

</h1>

    
      <p class="meta">
        








  


<time datetime="2012-04-01T09:00:00-06:00" pubdate data-updated="true">Apr 1<span>st</span>, 2012</time>
         &bull; <a rel="bookmark" href="/blog/blog/2012/04/01/building-data-structures-from-functions/">&infin;</a>
      </p>
    
  </header>

<div class="entry-content"><p>Here&#8217;s a puzzle I&#8217;ve adapted from <a href="http://mitpress.mit.edu/sicp/full-text/book/book-Z-H-14.html#%_sec_2.1.3">exercise 2.4</a> of SICP.</p>

<blockquote><p>Suppose you are programming in a language that only supports function application. That is, defining functions and applying arguments to these functions are the only things this language supports. Using only these building blocks, could you construct a linked list?</p></blockquote>

<p>Surprisingly, the answer is yes, and the exercise linked to above provides a partial solution. Below, I&#8217;ve translated that solution into Python, and completed the exercise:</p>

<figure class='code'><figcaption><span>Solution in Python</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="c"># Create a pair from l and r</span>
</span><span class='line'><span class="k">def</span> <span class="nf">cons</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">lambda</span> <span class="n">get</span><span class="p">:</span> <span class="n">get</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
</span><span class='line'><span class="c"># Given a pair, return the head (left) value.</span>
</span><span class='line'><span class="k">def</span> <span class="nf">head</span><span class="p">(</span><span class="n">pair</span><span class="p">):</span>
</span><span class='line'>    <span class="k">return</span> <span class="n">pair</span><span class="p">(</span><span class="k">lambda</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">:</span> <span class="n">l</span><span class="p">)</span>
</span><span class='line'><span class="c"># Give a pair, return the tail (right) value.</span>
</span><span class='line'><span class="k">def</span> <span class="nf">tail</span><span class="p">(</span><span class="n">pair</span><span class="p">):</span>
</span><span class='line'>    <span class="k">return</span> <span class="n">pair</span><span class="p">(</span><span class="k">lambda</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">:</span> <span class="n">r</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>First, let&#8217;s examine how these functions can be used, and then I&#8217;ll explain how they work. Consider the snippet below:</p>

<figure class='code'><figcaption><span>Usage Example</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="n">l1</span> <span class="o">=</span> <span class="n">cons</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span><span class='line'><span class="k">print</span> <span class="n">head</span><span class="p">(</span><span class="n">l1</span><span class="p">)</span>       <span class="c"># Prints 1</span>
</span><span class='line'><span class="k">print</span> <span class="n">tail</span><span class="p">(</span><span class="n">l1</span><span class="p">)</span>       <span class="c"># Prints 2</span>
</span><span class='line'><span class="n">l2</span> <span class="o">=</span> <span class="n">cons</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">l1</span><span class="p">)</span>
</span><span class='line'><span class="k">print</span> <span class="n">head</span><span class="p">(</span><span class="n">l2</span><span class="p">)</span>       <span class="c"># Prints 0</span>
</span><span class='line'><span class="k">print</span> <span class="n">head</span><span class="p">(</span><span class="n">tail</span><span class="p">(</span><span class="n">l2</span><span class="p">))</span> <span class="c"># Prints 1</span>
</span><span class='line'><span class="k">print</span> <span class="n">tail</span><span class="p">(</span><span class="n">tail</span><span class="p">(</span><span class="n">l2</span><span class="p">))</span> <span class="c"># Prints 2</span>
</span></code></pre></td></tr></table></div></figure>


<p>As can be seen, <code>cons()</code> is the constructor for this pair type. Give it two values, and it will create a pair of those two values. <code>head()</code> and <code>tail()</code> are the basic operators that let us access values inside these pairs; they return the left and right element of the pair, respectively. Also notice that we can create pairs of pairs. The last half of the example creates a pair composed of <code>0</code> and <code>(1,2)</code>. Why is this significant? Well, we&#8217;ve just made a linked list! Linked lists are simply pairs of pairs. The list <code>[1,2,3,4]</code> can, for example, be represented as <code>cons(1,cons(2,cons(3,cons(4,None))))</code>. What&#8217;s <code>None</code> doing at the end of the list? You can think of it like the <code>NULL</code> pointer at the end of a linked list in C. If a function were traversing the list, <code>None</code> would signify to the function that it has reached the end. Mathematically, you can think of a linked list as an inductively defined data structure, where <code>None</code> is the base case. <code>None</code> is referred to as the <em>empty list</em>.</p>

<p>Now for the interesting part. How do these functions work? First let&#8217;s look at the <code>cons()</code> function:</p>

<figure class='code'><figcaption><span>cons()</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="c"># Create a pair from l and r</span>
</span><span class='line'><span class="k">def</span> <span class="nf">cons</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">lambda</span> <span class="n">get</span><span class="p">:</span> <span class="n">get</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>This takes in two parameters (<code>l</code> and <code>r</code>) and returns a function.<sup>1</sup> This returned function takes yet another function, which it applies to <code>l</code> and <code>r</code> and returns the result. So, if we call <code>cons(1,2)</code>, we are returned a function, which takes a function and applies that function to the arguments <code>1</code> and <code>2</code>. If, for example, I called <code>cons(1,2)(lambda x, y: x+y)</code> I&#8217;d get <code>3</code>, because the addition function would be applied to <code>1</code> and <code>2</code>.</p>

<p>Now suppose that we didn&#8217;t want to add <code>l</code> and <code>r</code>. Instead, we wanted to pull either <code>l</code> or <code>r</code> out of a pair that was already constructed. In other words, given <code>list = cons(1,2)</code>, how could we pull the <code>1</code> or <code>2</code> out of the function stored in <code>list</code>? Well, all we need to do is pass it a function that returns only the left or right parameter. So, <code>cons(1,2)(lambda l, r: l)</code> would give us back <code>1</code>, and <code>cons(1,2)(lambda l,r: r)</code> would give us back <code>2</code>. This is almost exactly what the <code>head()</code> and <code>tail()</code> functions are doing! They take in a function (presumably produced by the <code>cons()</code> function), and apply either <code>lambda l,r: l</code> or <code>lambda l,r: r</code>. Just to cement this all together, below I step through the evaluation for the example <code>head(cons(1,2))</code>.</p>

<figure class='code'><figcaption><span>Evaluation Steps for head(cons(1,2,))</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="n">head</span><span class="p">(</span><span class="n">cons</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
</span><span class='line'><span class="o">-&gt;</span> <span class="n">head</span><span class="p">(</span><span class="k">lambda</span> <span class="n">get</span><span class="p">:</span> <span class="n">get</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</span><span class='line'><span class="o">-&gt;</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">get</span><span class="p">:</span> <span class="n">get</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))(</span><span class="k">lambda</span> <span class="n">l</span><span class="p">,</span><span class="n">r</span><span class="p">:</span> <span class="n">l</span><span class="p">)</span>
</span><span class='line'><span class="o">-&gt;</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">l</span><span class="p">,</span><span class="n">r</span><span class="p">:</span> <span class="n">l</span><span class="p">)(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</span><span class='line'><span class="o">-&gt;</span> <span class="mi">1</span>
</span></code></pre></td></tr></table></div></figure>


<p>And here is a bit of code that uses these new functions to add the elements of a list:</p>

<figure class='code'><figcaption><span>Sum Function</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="k">def</span> <span class="nf">sum_list</span><span class="p">(</span><span class="n">l</span><span class="p">):</span>
</span><span class='line'>    <span class="k">return</span> <span class="n">head</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="k">if</span> <span class="n">tail</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">==</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">head</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">+</span> <span class="n">sum_list</span><span class="p">(</span><span class="n">tail</span><span class="p">(</span><span class="n">l</span><span class="p">))</span>
</span><span class='line'><span class="n">sum_list</span><span class="p">(</span><span class="n">cons</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">cons</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">cons</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="bp">None</span><span class="p">))))</span> <span class="c"># Returns 6</span>
</span></code></pre></td></tr></table></div></figure>


<p>In the end, this might strike you as nothing more than a useless programming trick. In a sense that&#8217;s right. I&#8217;d never use this in my own code. What makes this technique so valuable is that it actually fits into the broader context of lambda calculus, which is a mathematical abstraction of computation. In the language of lambda calculus, you&#8217;re given only a very basic set of tools. Essentially all you have are simple one parameter functions (it doesn&#8217;t even have integers!). Incredibly, it turns out that that&#8217;s all you need for a Turing complete language. It&#8217;s possible to build integers, conditionals, loops, arithmetic operations, and (as you&#8217;ve seen here) data structures out of these simple building blocks. As a next step, and to see this for yourself, it might be fun to take a minute and see how the code presented here could be modified to give you binary trees, or even graphs. After that, you could check out this incredible article on writing the infamous <a href="http://www.codinghorror.com/blog/2007/02/why-cant-programmers-program.html">FizzBuzz</a> exercise <a href="http://experthuman.com/programming-with-nothing">in Ruby using only functions</a>.</p>

<h3>Notes</h3>

<ol>
<li>Technically, this is really a closure, which is a function with some of its variables already set. In the terminology of the PL world, it&#8217;s a function bundled with its environment (the set of variables in its outer scope).</li>
</ol>

</div>

  <footer>
    
    
  </footer>


    </article>
  
    










    <article >
      
  <header>
    <h1 class="entry-title">

<a href="/blog/blog/2012/02/05/super-bowl-probabilities/">Super Bowl Probabilities: The Coin Toss</a>

</h1>

    
      <p class="meta">
        








  


<time datetime="2012-02-05T09:53:00-07:00" pubdate data-updated="true">Feb 5<span>th</span>, 2012</time>
         &bull; <a rel="bookmark" href="/blog/blog/2012/02/05/super-bowl-probabilities/">&infin;</a>
      </p>
    
  </header>

<div class="entry-content"><p>Browsing through my Twitter stream, I came across a blog post discussing an allegedly 3.8-sigma event: <a href="http://blogs.discovermagazine.com/cosmicvariance/2012/02/04/a-3-8-sigma-anomaly/">Apparently the last 14 Super Bowl coin tosses have been won by the NFC</a>. What are the chances of this? The blog linked to above claims a probability of (1/2)<sup>13</sup>. Another <a href="http://www.outsidethebeltway.com/super-bowl-coin-flip/">blog</a> claims (1/2)<sup>14</sup>. Which is correct? Before I get into the mathematics, I&#8217;ll try to disentangle three different questions:</p>

<ol>
<li>Out of 14 tosses, what&#8217;s the probability that they all come up heads?</li>
<li>Out of 14 tosses, what&#8217;s the probability that one team wins all of them?</li>
<li>Out of 45 tosses (one for each Super Bowl), what&#8217;s the probability that one team wins a string of 14 of them?<sup>1</sup></li>
</ol>


<p><strong>(1/2)<sup>14</sup></strong> is the correct answer to question (1). There&#8217;s a 1 in 2 chance of getting heads. The probability of getting heads 14 times out of 14 tosses is therefore (1/2)<sup>14</sup>.</p>

<p><strong>(1/2)<sup>13</sup></strong> is the correct answer to question (2). If you call a coin in the air, there&#8217;s 1 in 2 chance you&#8217;ll win the toss. Out of 14 tosses, the chance that <em>either</em> the NFC will win the toss 14 times <em>or</em> the AFC will win the toss 14 times is: (1/2)<sup>14</sup> + (1/2)<sup>14</sup> = (1/2)<sup>13</sup>.</p>

<p>The last situation is much more difficult to calculate, and similar questions are often the cause for much surprise. For example, if you toss a coin 20 times, do you think it&#8217;s likely or unlikely that you&#8217;ll get a string of 5 heads in a row? It seems like this should be unlikely. After all, the probability of tossing a coin 5 times, and ending up with heads every time is quite small: (1/2)<sup>5</sup> = 1/32  (approx. 3%). Believe it or not, the actual probability is around 25%.<sup>2</sup></p>

<p>How are these probabilities found? One solution is a rather nasty recursive formula.</p>

<blockquote><p>  A similar recursion can be given to calculate the probability that in <em>n</em> fair coin tosses a run of <em>r</em> heads or <em>r</em> tails occurs. In this case, we say that the tossing process is in state <em>(i, k)</em> when there are <em>k</em> tosses still to go and the last <em>i</em> tosses all showed the same outcome but so far no run of <em>r</em> heads or <em>r</em> tails has occurred. The probability <em>v<sub>k</sub>(i)</em> is defined as</p>

<p>  v<sub>k</sub>(i) = the probability of getting a run of <em>r</em> heads or <em>r</em> tails during <em>n</em> tosses when the current state of the tossing process is <em>(i, k)</em>.</p>

<p>The probability <em>v<sub>n-1</sub>(1)</em> is being sought (why?). Verify for yourself that the following recursion applies for k = 1,2,&#8230;,<em>n</em>.</p>

<p>  v<sub>k</sub> = 0.5*v<sub>k-1</sub>(i + 1) + 0.5*v<sub>k-1</sub>(1) for i =,&#8230;,r - 1.</p>

<p>The boundary conditions are <em>v<sub>0</sub>(i) = 0</em> for <em>1 &lt;= i &lt;= r -1</em> and <em>v<sub>j</sub>(r) = 1</em> for <em>0 &lt;= j &lt;= n - 1</em>.<sup>3</sup></p></blockquote>

<p>I&#8217;m actually not sure why we&#8217;re looking for <em>v<sub>n-1</sub>(1)</em> as opposed to <em>v<sub>n</sub>(0)</em>. I tested it for a few values, and those expressions seem to be equal.<sup>4</sup> In any case, the formula is dense, but you can see the logic behind it. If you&#8217;re in the midst of a streak of heads, and your next flip comes up heads, your state is now <em>(i+1, k-1)</em>. That is, your streak has increased, but your tosses to go has decreased. This explains the first half of the formula: <em>0.5*v<sub>k-1</sub>(i + 1)</em>. The other case is that you&#8217;re in the midst of a streak of heads, but then you get a tail, so your state becomes <em>(1, k-1)</em>. That is, you now have a streak of 1 tail, and your total number of tosses to go decrements by one. This explains the last half of the equation. The equation then branches out like a tree, solving for each possibility along the way. Here&#8217;s a bit of Scheme that implements this:</p>

<figure class='code'><figcaption><span>An Exact Solution in Scheme</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='scheme'><span class='line'><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">coin-streak</span> <span class="nv">n</span> <span class="nv">r</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">cs-helper</span> <span class="nv">k</span> <span class="nv">i</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="k">and </span><span class="p">(</span><span class="nb">&lt;= </span><span class="mi">1</span> <span class="nv">i</span><span class="p">)</span> <span class="p">(</span><span class="nb">&lt;= </span><span class="nv">i</span> <span class="p">(</span><span class="nb">- </span><span class="nv">r</span> <span class="mi">1</span><span class="p">))</span> <span class="p">(</span><span class="nb">= </span><span class="nv">k</span> <span class="mi">0</span><span class="p">))</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>            <span class="p">((</span><span class="k">and </span><span class="p">(</span><span class="nb">&lt;= </span><span class="mi">0</span> <span class="nv">k</span><span class="p">)</span> <span class="p">(</span><span class="nb">&lt;= </span><span class="nv">k</span> <span class="p">(</span><span class="nb">- </span><span class="nv">n</span> <span class="mi">1</span><span class="p">))</span> <span class="p">(</span><span class="nb">= </span><span class="nv">i</span> <span class="nv">r</span><span class="p">))</span> <span class="mi">1</span><span class="p">)</span>
</span><span class='line'>            <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">+</span>
</span><span class='line'>                   <span class="p">(</span><span class="nb">* </span><span class="p">(</span><span class="nb">/ </span><span class="mi">1</span> <span class="mi">2</span><span class="p">)</span> <span class="p">(</span><span class="nf">ct-string</span> <span class="nv">r</span> <span class="nv">n</span> <span class="p">(</span><span class="nb">- </span><span class="nv">k</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">i</span> <span class="mi">1</span><span class="p">)))</span>
</span><span class='line'>                   <span class="p">(</span><span class="nb">* </span><span class="p">(</span><span class="nb">/ </span><span class="mi">1</span> <span class="mi">2</span><span class="p">)</span> <span class="p">(</span><span class="nf">ct-string</span> <span class="nv">r</span> <span class="nv">n</span> <span class="p">(</span><span class="nb">- </span><span class="nv">k</span> <span class="mi">1</span><span class="p">)</span> <span class="mi">1</span> <span class="p">))))</span>
</span><span class='line'>            <span class="p">))</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cs-helper</span> <span class="p">(</span><span class="nb">- </span><span class="nv">n</span> <span class="mi">1</span><span class="p">)</span> <span class="mi">1</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure>


<p>Notice that this problem quickly becomes intractable for large values of <em>n</em>. Each call branches into two different calls, giving an exponential growth (props to the first person who posts a tail recursive memoization). This is why I prefer solving this by simulation. What we need to do is simulate 45 coin flips, and check if we&#8217;ve encountered a string of 14 heads or 14 tails. Do this, say, 100,000 times and see how often this event occurs.</p>

<figure class='code'><figcaption><span>ctsim.py: An Approximation by Simulation in Python</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="c">#!/usr/bin/python -O</span>
</span><span class='line'>
</span><span class='line'><span class="kn">import</span> <span class="nn">random</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">sys</span>
</span><span class='line'>
</span><span class='line'><span class="n">STREAK_LEN</span>  <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span class='line'><span class="n">TOSSES</span>      <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</span><span class='line'><span class="n">TRIALS</span>      <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
</span><span class='line'>
</span><span class='line'><span class="k">def</span> <span class="nf">simulation</span><span class="p">(</span><span class="n">trials</span><span class="p">,</span> <span class="n">tosses</span><span class="p">,</span> <span class="n">streak</span><span class="p">):</span>
</span><span class='line'>    <span class="sd">&#39;&#39;&#39; Simulates *trials* trials of *tosses* tosses and returns the</span>
</span><span class='line'><span class="sd">        fraction of trials that contained at least one streak</span>
</span><span class='line'><span class="sd">        of *streak* or higher.</span>
</span><span class='line'><span class="sd">    &#39;&#39;&#39;</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">def</span> <span class="nf">run_trial</span><span class="p">():</span>
</span><span class='line'>        <span class="sd">&#39;&#39;&#39; Flips a coin *tosses* times and returns True if a streak of</span>
</span><span class='line'><span class="sd">            *streak* length is encountered.</span>
</span><span class='line'><span class="sd">        &#39;&#39;&#39;</span>
</span><span class='line'>        <span class="n">cur_streak</span> <span class="o">=</span> <span class="mi">1</span>      <span class="c"># Length of the current streak.</span>
</span><span class='line'>        <span class="n">prev_outcome</span> <span class="o">=</span> <span class="bp">None</span> <span class="c"># Outcome of a previous toss.</span>
</span><span class='line'>        <span class="c"># Simulate the tosses.</span>
</span><span class='line'>        <span class="k">for</span> <span class="n">toss</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">tosses</span><span class="p">):</span>
</span><span class='line'>            <span class="n">outcome</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span><span class='line'>            <span class="c"># If the last toss is the same as the current toss,</span>
</span><span class='line'>            <span class="c"># increment the length of the current streak.</span>
</span><span class='line'>            <span class="k">if</span> <span class="n">outcome</span> <span class="o">==</span> <span class="n">prev_outcome</span><span class="p">:</span>
</span><span class='line'>                <span class="n">cur_streak</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span class='line'>            <span class="k">else</span><span class="p">:</span>
</span><span class='line'>                <span class="n">cur_streak</span> <span class="o">=</span> <span class="mi">1</span>
</span><span class='line'>
</span><span class='line'>            <span class="c"># If the current streak is equal to the target</span>
</span><span class='line'>            <span class="c"># length, return True</span>
</span><span class='line'>            <span class="k">if</span> <span class="n">cur_streak</span> <span class="o">==</span> <span class="n">streak</span><span class="p">:</span>
</span><span class='line'>                <span class="k">return</span> <span class="bp">True</span>
</span><span class='line'>
</span><span class='line'>            <span class="n">prev_outcome</span> <span class="o">=</span> <span class="n">outcome</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">return</span> <span class="bp">False</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">streak_count</span> <span class="o">=</span> <span class="mi">0</span>
</span><span class='line'>    <span class="c"># Simulate all the trials, and keep track of how many had</span>
</span><span class='line'>    <span class="c"># a streak.</span>
</span><span class='line'>    <span class="k">for</span> <span class="n">trial</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">trials</span><span class="p">):</span>
</span><span class='line'>        <span class="n">had_a_streak</span> <span class="o">=</span> <span class="n">run_trial</span><span class="p">()</span>
</span><span class='line'>        <span class="k">if</span> <span class="n">had_a_streak</span><span class="p">:</span>
</span><span class='line'>            <span class="n">streak_count</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">return</span> <span class="n">streak_count</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">trials</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&quot;__main__&quot;</span><span class="p">:</span>
</span><span class='line'>    <span class="k">print</span> <span class="n">simulation</span><span class="p">(</span><span class="n">TRIALS</span><span class="p">,</span> <span class="n">TOSSES</span><span class="p">,</span> <span class="n">STREAK_LEN</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p></p>

<p>We can now simulate the Super Bowl situation by looking for a streak of 14 wins out of 45 tosses with 100,000 simulations.</p>

<figure class='code'><figcaption><span>ctsim.py Usage</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>% ./ctsim.py 14 45 100000
</span><span class='line'>0.00202
</span></code></pre></td></tr></table></div></figure>


<p>So, the probability of this happening is <strong>0.00202</strong> or around <strong>0.2%</strong>. This is still tiny, but not as small as (1/2)<sup>13</sup> (approx. 0.00012 or 0.012%).</p>

<h2>Notes:</h2>

<ol>
<li>Even this is slightly ambiguous. The exact question that we&#8217;ll be looking at is: What is the probability that one team will have at least one winning streak of at least 14 tosses.</li>
<li>Tijms, H. (2010). Understanding probability: Chance rules in everyday life. (2 ed.). Cambridge, UK: Cambridge University Press.</li>
<li>Ibid.</li>
<li>Perhaps the equation <em>v<sub>n</sub>(0)</em> is technically undefined. That is, <em>i</em> cannot equal 0 because you must have a streak of at least 1 head or 1 tail. Nevertheless, it looks like the formula still works for this technically undefined state.</li>
</ol>

</div>

  <footer>
    
    
  </footer>


    </article>
  
    










    <article >
      
  <header>
    <h1 class="entry-title">

<a href="/blog/blog/2012/01/28/implementing-a-logic-evaluator-without-if-expressions/">Implementing a Logic Evaluator Without If-expressions or Boolean Operators</a>

</h1>

    
      <p class="meta">
        








  


<time datetime="2012-01-28T10:19:00-07:00" pubdate data-updated="true">Jan 28<span>th</span>, 2012</time>
         &bull; <a rel="bookmark" href="/blog/blog/2012/01/28/implementing-a-logic-evaluator-without-if-expressions/">&infin;</a>
      </p>
    
  </header>

<div class="entry-content"><p>I&#8217;ve slowly been making my way through <a href="http://www.scala-lang.org/sites/default/files/linuxsoft_archives/docu/files/ScalaOverview.pdf">An Overview of the Scala Programming Language</a> [PDF], and was struck by this interesting implementation of Booleans:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="k">abstract</span> <span class="k">class</span> <span class="nc">Bool</span> <span class="o">{</span>
</span><span class='line'>  <span class="k">def</span> <span class="o">&amp;&amp;</span> <span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="o">=&gt;</span> <span class="nc">Bool</span><span class="o">)</span><span class="k">:</span> <span class="kt">Bool</span>
</span><span class='line'>  <span class="k">def</span> <span class="o">||</span> <span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="o">=&gt;</span> <span class="nc">Bool</span><span class="o">)</span><span class="k">:</span> <span class="kt">Bool</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'><span class="k">object</span> <span class="nc">False</span> <span class="k">extends</span> <span class="nc">Bool</span> <span class="o">{</span>
</span><span class='line'>  <span class="k">def</span> <span class="o">&amp;&amp;</span> <span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="o">=&gt;</span> <span class="nc">Bool</span><span class="o">)</span><span class="k">:</span> <span class="kt">Bool</span> <span class="o">=</span> <span class="k">this</span>
</span><span class='line'>  <span class="k">def</span> <span class="o">||</span> <span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="o">=&gt;</span> <span class="nc">Bool</span><span class="o">)</span><span class="k">:</span> <span class="kt">Bool</span> <span class="o">=</span> <span class="n">x</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'><span class="k">object</span> <span class="nc">True</span> <span class="k">extends</span> <span class="nc">Bool</span> <span class="o">{</span>
</span><span class='line'>  <span class="k">def</span> <span class="o">&amp;&amp;</span> <span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="o">=&gt;</span> <span class="nc">Bool</span><span class="o">)</span><span class="k">:</span> <span class="kt">Bool</span> <span class="o">=</span> <span class="n">x</span>
</span><span class='line'>  <span class="k">def</span> <span class="o">||</span> <span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="o">=&gt;</span> <span class="nc">Bool</span><span class="o">)</span><span class="k">:</span> <span class="kt">Bool</span> <span class="o">=</span> <span class="k">this</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>If you&#8217;re not a Scala programmer, don&#8217;t let the syntax trip you up. It&#8217;s pretty straightforward. <code>True</code> and <code>False</code> are singleton objects that inherit from the <code>abstract class Bool</code>. Each object implements the <code>&amp;&amp;</code> (and) and <code>||</code> (or) operators. As you&#8217;d expect, they each take a <code>Bool</code> as an argument and return a <code>Bool</code>. When you execute:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="nc">True</span> <span class="o">&amp;&amp;</span> <span class="nc">False</span>
</span></code></pre></td></tr></table></div></figure>


<p>It applies <code>True</code>&#8217;s <code>&amp;&amp;</code> method to <code>False</code>, and correctly returns <code>x</code>, which is, in this case, <code>False</code>.</p>

<p>What&#8217;s so interesting about this is the absence of any if-expressions or built-in boolean operators. To illustrate, a less clever, but more obvious implementation would be as follows:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="k">def</span> <span class="n">and</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Boolean</span><span class="o">,</span> <span class="n">y</span><span class="k">:</span> <span class="kt">Boolean</span><span class="o">)</span><span class="k">:</span> <span class="kt">Boolean</span> <span class="o">=</span> <span class="o">{</span>
</span><span class='line'>  <span class="k">if</span><span class="o">(</span><span class="n">x</span><span class="o">)</span>
</span><span class='line'>      <span class="k">if</span><span class="o">(</span><span class="n">y</span><span class="o">)</span>
</span><span class='line'>          <span class="kc">true</span>
</span><span class='line'>      <span class="k">else</span>
</span><span class='line'>          <span class="kc">false</span>
</span><span class='line'>  <span class="k">else</span>
</span><span class='line'>      <span class="kc">false</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>So, if <code>x</code> and <code>y</code> are both <code>true</code>, return <code>true   </code>, otherwise return <code>false</code> (Scala returns the value of the last executed expression). It works, but doesn&#8217;t win any style points. The nested if-expressions are especially ugly.<sup>1<sup></p>

<p>So, this is a neat way of cutting down on if-expressions. Can it be extended to the other operations? Yes:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="k">object</span> <span class="nc">True</span> <span class="k">extends</span> <span class="nc">Bool</span> <span class="o">{</span>
</span><span class='line'>  <span class="k">def</span> <span class="o">&amp;&amp;</span> <span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="o">=&gt;</span> <span class="nc">Bool</span><span class="o">)</span><span class="k">:</span> <span class="kt">Bool</span> <span class="o">=</span> <span class="n">x</span>
</span><span class='line'>  <span class="k">def</span> <span class="o">||</span> <span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="o">=&gt;</span> <span class="nc">Bool</span><span class="o">)</span><span class="k">:</span> <span class="kt">Bool</span> <span class="o">=</span> <span class="k">this</span>
</span><span class='line'>  <span class="k">def</span> <span class="n">unary_!</span> <span class="k">:</span> <span class="kt">Bool</span> <span class="o">=</span> <span class="nc">False</span>
</span><span class='line'>  <span class="k">def</span> <span class="n">xor</span> <span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="o">=&gt;</span> <span class="nc">Bool</span><span class="o">)</span><span class="k">:</span> <span class="kt">Bool</span> <span class="o">=</span> <span class="o">!</span><span class="n">x</span>
</span><span class='line'>  <span class="k">def</span> <span class="n">if_</span> <span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="o">=&gt;</span> <span class="nc">Bool</span><span class="o">)</span><span class="k">:</span> <span class="kt">Bool</span> <span class="o">=</span> <span class="k">this</span>
</span><span class='line'>  <span class="k">def</span> <span class="n">iff</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="o">=&gt;</span> <span class="nc">Bool</span><span class="o">)</span><span class="k">:</span> <span class="kt">Bool</span> <span class="o">=</span> <span class="n">x</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">object</span> <span class="nc">False</span> <span class="k">extends</span> <span class="nc">Bool</span> <span class="o">{</span>
</span><span class='line'>  <span class="k">def</span> <span class="o">&amp;&amp;</span> <span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="o">=&gt;</span> <span class="nc">Bool</span><span class="o">)</span><span class="k">:</span> <span class="kt">Bool</span> <span class="o">=</span> <span class="k">this</span>
</span><span class='line'>  <span class="k">def</span> <span class="o">||</span> <span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="o">=&gt;</span> <span class="nc">Bool</span><span class="o">)</span><span class="k">:</span> <span class="kt">Bool</span> <span class="o">=</span> <span class="n">x</span>
</span><span class='line'>  <span class="k">def</span> <span class="n">unary_!</span> <span class="k">:</span> <span class="kt">Bool</span> <span class="o">=</span> <span class="nc">True</span>
</span><span class='line'>  <span class="k">def</span> <span class="n">xor</span> <span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="o">=&gt;</span> <span class="nc">Bool</span><span class="o">)</span><span class="k">:</span> <span class="kt">Bool</span> <span class="o">=</span> <span class="n">x</span>
</span><span class='line'>  <span class="k">def</span> <span class="n">if_</span> <span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="o">=&gt;</span> <span class="nc">Bool</span><span class="o">)</span><span class="k">:</span> <span class="kt">Bool</span> <span class="o">=</span> <span class="o">!</span><span class="k">this</span>
</span><span class='line'>  <span class="k">def</span> <span class="n">iff</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="o">=&gt;</span> <span class="nc">Bool</span><span class="o">)</span><span class="k">:</span> <span class="kt">Bool</span> <span class="o">=</span> <span class="o">!</span><span class="n">x</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>One thing I like about this implementation is the pleasing symmetry between <code>True</code>&#8217;s methods and <code>False</code>&#8217;s methods. The <code>unary_!</code> (not) method is trivially opposite. <code>True</code> returns <code>False</code> and vice versa, but the symmetry continues throughout <code>xor</code>, <code>if_</code>, and <code>iff</code>. For example, <code>False</code>&#8217;s <code>xor</code> returns its parameter, while <code>True</code>&#8217;s <code>xor</code> returns the opposite of its parameter. <code>False xor True</code> returns <code>True</code>, whereas <code>True xor True</code> returns <code>False</code>. I&#8217;ll leave verifying the rest of these rules as an exercise to the reader.<sup>2</sup></p>

<p>It&#8217;s also interesting to compare this to the <a href="http://en.wikipedia.org/wiki/State_pattern">State Pattern</a>, where a state machine is simulated through the use of objects that implement a common interface. Each state is an object, and transitioning between states is as easy as switching between the different objects. Without this pattern, the alternative would be a complex set of if-expressions dictating what you&#8217;re allowed to do in a certain state, and which states you can switch to given your current state. The State Pattern essentially hides all this behind polymorphism, similar to what&#8217;s happening in the logic evaluator.</p>

<h2>Notes</h2>

<ol>
<li>You can cut it down to one if-expression if you&#8217;re on your toes.</li>
<li>Note that <code>if_</code> is backwards. <code>True if_ False</code> is the same as <code>False -&gt; True</code>, because that&#8217;s closer to the English.</li>
</ol>

</div>

  <footer>
    
    
  </footer>


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/blog/page/2/">&larr; Older</a>
    
    <a href="/blog/blog/archives">Blog Archives</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/blog/2012/05/05/permutations-an-interview-question/">Permutations: An Interview Question</a>
      </li>
    
      <li class="post">
        <a href="/blog/blog/2012/04/07/look-ma-no-loops/">Look, Ma! No Loops: Reversing Word Order</a>
      </li>
    
      <li class="post">
        <a href="/blog/blog/2012/04/01/building-data-structures-from-functions/">Building Data Structures from Functions</a>
      </li>
    
      <li class="post">
        <a href="/blog/blog/2012/02/05/super-bowl-probabilities/">Super Bowl Probabilities: The Coin Toss</a>
      </li>
    
      <li class="post">
        <a href="/blog/blog/2012/01/28/implementing-a-logic-evaluator-without-if-expressions/">Implementing a Logic Evaluator Without if-expressions or Boolean Operators</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/beala">@beala</a> on GitHub
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'beala',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/blog/javascripts/github.js" type="text/javascript"> </script>
</section>


<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("beala", 4, false);
    });
  </script>
  <script src="/blog/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/beala" class="twitter-follow-button" data-show-count="false">Follow @beala</a>
  
</section>


<section>
  <h1>My Pinboard</h1>
  <ul id="pinboard_linkroll">Fetching linkroll&#8230;</ul>
  <p><a href="http://pinboard.in/u:beala">My Pinboard Bookmarks &raquo;</a></p>
</section>
<script type="text/javascript">
  var linkroll = 'pinboard_linkroll'; //id target for pinboard list
  var pinboard_user = "beala"; //id target for pinboard list
  var pinboard_count = 3; //id target for pinboard list
  (function(){
    var pinboardInit = document.createElement('script');
    pinboardInit.type = 'text/javascript';
    pinboardInit.async = true;
    pinboardInit.src = '/javascripts/pinboard.js';
    document.getElementsByTagName('head')[0].appendChild(pinboardInit);
  })();
</script>




  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2012 - Alex Beal -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'usrsbin';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
